<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>å‹•ç‰©æ—©æŠ¼ã—ã‚²ãƒ¼ãƒ </title>
  <style>
    body {
      text-align: center;
      font-family: sans-serif;
      margin: 0;
      padding: 20px;
      background: #f0f0f0;
    }
    #game-container {
      max-width: 600px;
      margin: 0 auto;
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }
    #question {
      font-size: 2em;
      margin: 20px 0;
    }
    /* ãƒœã‚¿ãƒ³ã®é«˜ã•ã¨ã‚¢ã‚¤ã‚³ãƒ³ã®å¤§ãã•ã‚’å€ã« */
    #buttons button {
      font-size: 4em;         /* ã‚¢ã‚¤ã‚³ãƒ³ã‚µã‚¤ã‚ºã‚’å€ã« */
      margin: 5px;
      padding: 20px 40px;      /* ãƒœã‚¿ãƒ³ã®é«˜ã•ã‚‚å€ã« */
      cursor: pointer;
    }
    #controls button {
      font-size: 1.2em;
      padding: 10px 20px;
      margin: 5px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="game-container">
    <h1>å‹•ç‰©æ—©æŠ¼ã—ã‚²ãƒ¼ãƒ </h1>
    <div id="timer">Time: 0.00 s</div>
    <div id="score">Score: 0</div>
    <div id="question"></div>
    <div id="buttons"></div>
    <!-- å‹•ç‰©ãƒœã‚¿ãƒ³ã‹ã‚‰æ”¹è¡Œ4ã¤åˆ†ä¸‹ã«é…ç½® -->
    <div id="controls">
      <br><br><br><br>
      <button id="start-btn">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
      <button id="restart-btn" disabled>ãƒªã‚¹ã‚¿ãƒ¼ãƒˆ</button>
    </div>
  </div>

  <script>
    // å‹•ç‰©ã®èª­ã¿ä»®åã®å€™è£œ
    const animalReadings = [
      "ã„ã¬", "çŠ¬", 
      "ã­ã“", "ãƒã‚³", "çŒ«", 
      "ã†ã•ã", "ã‚¦ã‚µã‚®", "å…", 
      "ã‚¾ã‚¦", 
      "ãƒ©ã‚¤ã‚ªãƒ³", "ç…å­", 
      "ãã¤ã­", 
      "ã‚­ãƒªãƒ³", 
      "ã—ã¾ã†ã¾", 
      "ã‚µãƒ«"
    ];
    
    // å„èª­ã¿ä»®åãŒã©ã®å‹•ç‰©ã‹ã®ãƒãƒƒãƒ”ãƒ³ã‚°
    const readingToAnimal = {
      "ã„ã¬": "dog",
      "çŠ¬": "dog",
      "ã­ã“": "cat",
      "ãƒã‚³": "cat",
      "çŒ«": "cat",
      "ã†ã•ã": "rabbit",
      "ã‚¦ã‚µã‚®": "rabbit",
      "å…": "rabbit",
      "ã‚¾ã‚¦": "elephant",
      "ãƒ©ã‚¤ã‚ªãƒ³": "lion",
      "ç…å­": "lion",
      "ãã¤ã­": "fox",
      "ã‚­ãƒªãƒ³": "giraffe",
      "ã—ã¾ã†ã¾": "zebra",
      "ã‚µãƒ«": "monkey"
    };

    // æ­£è§£ã¨ã™ã‚‹ã‚¢ã‚¤ã‚³ãƒ³
    const animalMapping = {
      dog: "ğŸ•",
      cat: "ğŸˆ",
      rabbit: "ğŸ‡",
      elephant: "ğŸ˜",
      lion: "ğŸ¦",
      fox: "ğŸ¦Š",
      giraffe: "ğŸ¦’",
      zebra: "ğŸ¦“",
      monkey: "ğŸ’"
    };

    // ä½¿ç”¨ã™ã‚‹å…¨10ç¨®ã®ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆæ­£è§£ã«å‡ºã‚‹ã‚‚ã®ä»¥å¤–ã®ãƒ‡ã‚³ã‚¤ã‚‚å«ã‚€ï¼‰
    const icons = ["ğŸ•", "ğŸˆ", "ğŸ‡", "ğŸ˜", "ğŸ¦", "ğŸ¦Š", "ğŸ¦“", "ğŸ’", "ğŸ¦’", "ğŸ·"];

    let currentRound = 0;
    let score = 0;
    let startTime = null;
    let timerInterval = null;

    // ã‚¿ã‚¤ãƒãƒ¼è¡¨ç¤ºã®æ›´æ–°
    function updateTimer() {
      const now = new Date();
      const elapsed = (now - startTime) / 1000;
      document.getElementById("timer").innerText = "Time: " + elapsed.toFixed(2) + " s";
    }

    // é…åˆ—ã‚·ãƒ£ãƒƒãƒ•ãƒ«ï¼ˆFisherâ€“Yatesã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼‰
    function shuffleArray(array) {
      const arr = array.slice();
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    // æ¬¡ã®å•é¡Œã¸é€²ã‚€
    function nextQuestion() {
      if (currentRound >= 10) {
        endGame();
        return;
      }
      currentRound++;
      // ãƒ©ãƒ³ãƒ€ãƒ ãªèª­ã¿ä»®åã‚’é¸æŠ
      const randomIndex = Math.floor(Math.random() * animalReadings.length);
      const reading = animalReadings[randomIndex];
      document.getElementById("question").innerText = reading;

      // æ­£è§£ã‚¢ã‚¤ã‚³ãƒ³ã®æ±ºå®š
      const animalKey = readingToAnimal[reading];
      const correctIcon = animalMapping[animalKey];

      // æ­£è§£ã‚¢ã‚¤ã‚³ãƒ³ä»¥å¤–ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«4ã¤ã®ãƒ‡ã‚³ã‚¤ã‚’é¸æŠ
      let decoyIcons = icons.filter(icon => icon !== correctIcon);
      decoyIcons = shuffleArray(decoyIcons).slice(0, 4);
      // æ­£è§£ã¨ãƒ‡ã‚³ã‚¤ã‚’åˆä½“ã—ã¦ã‚·ãƒ£ãƒƒãƒ•ãƒ«
      let options = shuffleArray(decoyIcons.concat([correctIcon]));

      // ãƒœã‚¿ãƒ³ç¾¤ã®æç”»
      const buttonsDiv = document.getElementById("buttons");
      buttonsDiv.innerHTML = "";
      options.forEach(icon => {
        const button = document.createElement("button");
        button.innerText = icon;
        button.addEventListener("click", function() {
          if (icon === correctIcon) {
            score += 10;
          } else {
            score -= 5;
          }
          document.getElementById("score").innerText = "Score: " + score;
          nextQuestion();
        });
        buttonsDiv.appendChild(button);
      });
    }

    // ã‚²ãƒ¼ãƒ é–‹å§‹
    function startGame() {
      currentRound = 0;
      score = 0;
      document.getElementById("score").innerText = "Score: " + score;
      startTime = new Date();
      document.getElementById("timer").innerText = "Time: 0.00 s";
      timerInterval = setInterval(updateTimer, 10);
      document.getElementById("start-btn").disabled = true;
      document.getElementById("restart-btn").disabled = true;
      nextQuestion();
    }

    // ã‚²ãƒ¼ãƒ çµ‚äº†å‡¦ç†ï¼ˆæœ€çµ‚ã‚¹ã‚³ã‚¢ï¼scoreÃ—scoreÃ·timeï¼‰
    function endGame() {
      clearInterval(timerInterval);
      const elapsed = (new Date() - startTime) / 1000; // çµŒéæ™‚é–“ï¼ˆç§’ï¼‰
      const finalScore = (score * score) / elapsed;
      document.getElementById("question").innerText = "ã‚²ãƒ¼ãƒ çµ‚äº†ï¼ æœ€çµ‚ã‚¹ã‚³ã‚¢: " + finalScore.toFixed(2);
      document.getElementById("buttons").innerHTML = "";
      document.getElementById("restart-btn").disabled = false;
    }

    // ã‚²ãƒ¼ãƒ ãƒªã‚»ãƒƒãƒˆ
    function restartGame() {
      document.getElementById("start-btn").disabled = false;
      document.getElementById("timer").innerText = "Time: 0.00 s";
      document.getElementById("score").innerText = "Score: 0";
      document.getElementById("question").innerText = "";
    }

    // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®ç™»éŒ²
    document.getElementById("start-btn").addEventListener("click", startGame);
    document.getElementById("restart-btn").addEventListener("click", restartGame);
  </script>
</body>
</html>